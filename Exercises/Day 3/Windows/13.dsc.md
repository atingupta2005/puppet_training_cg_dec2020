# PowerShell Desired State Configuration (DSC)
## Installation
```
puppet module install puppetlabs-dsc --version 1.9.4
```

## Description
 - The Puppet dsc module manages Windows PowerShell DSC (Desired State Configuration) resources.

### Installing IIS
```
dsc_windowsfeature {'IIS':
  dsc_ensure => 'present',
  dsc_name   => 'Web-Server',
}
```

### Installing Packages with DSC
 - https://www.python.org/ftp/python/2.7.2/python-2.7.2.msi
 - To get the product id use the script: get-product-id.ps1
 - 
```
dsc_package{'installpython'
  dsc_ensure    => 'Present',
  dsc_name      => 'Python 2.7.2',
  dsc_productid => '2E295B5B-1AD4-4D36-97C2-A316084722CF'
  dsc_path      => 'C:\\python-2.7.2.msi',
}

```

### Setting Registry Values
```
dsc_registry {'registry_test':
  dsc_ensure    => 'Present'
  dsc_key       => 'HKEY_LOCAL_MACHINE\SOFTWARE\ExampleKey'
  dsc_valuename => 'TestValue'
  dsc_valuedata => 'TestData'
}
```

### Adding or Removing Windows Features
 - Add a Windows Feature
```
dsc_windowsfeature {'featureexample':
  dsc_ensure = 'present'
  dsc_name = 'Web-Server'
}
```

 - Remove a Windows Feature
```
dsc_windowsfeature {'featureexample':
  dsc_ensure = 'absent'
  dsc_name = 'Web-Server'
}
```

